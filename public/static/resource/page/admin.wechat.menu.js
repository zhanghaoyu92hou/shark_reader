layui.config({base:"/static/layadmin/lay_extend/tree/"}).use(["jquery","layer","table","treetable"],function(){var e=layui.jquery,a=layui.layer,c=layui.table,b=layui.treetable;function d(){layLoad("数据加载中...");b.render({treeColIndex:0,treeSpid:"0",treeIdName:"id",treePidName:"pid",treeDefaultClose:true,treeLinkage:false,elem:"#table-block",url:window.location.href,page:false,height:"full-220",id:"table-block",cols:[[{field:"name",minWidth:120,title:"菜单名称"},{field:"type_name",minWidth:100,title:"事件类型",align:"center"},{field:"value",minWidth:200,title:"事件值"},{title:"排序",minWidth:140,align:"center",templet:function(g){var f="";f+='<a class="layui-btn layui-btn-primary layui-btn-xs" lay-event="sortUp">向上排序</a>';f+='<a class="layui-btn layui-btn-primary layui-btn-xs" lay-event="sortDown">向下排序</a>';return f}},{title:"操作",minWidth:200,align:"center",templet:function(h){var g="";var f=parseInt(h.pid);if(f===0){g+='<a class="layui-btn layui-btn-normal layui-btn-xs" href="'+h.add_url+'">新增子菜单</a>'}g+='<a class="layui-btn layui-btn-normal layui-btn-xs" href="'+h.do_url+'">编辑</a>';g+='<a class="layui-btn layui-btn-danger layui-btn-xs" lay-event="delete">删除</a>';return g}}]],done:function(f){a.closeAll();b.expandAll("#table-block")}})}d();c.on("tool(table-block)",function(h){var g=h.data;var f={id:g.id,event:h.event};if(f.event==="delete"){ajaxPost($opt_url,f,"删除菜单会将所有子菜单一并删除，确认要继续吗？",function(){layOk("删除成功");setTimeout(function(){layLoad("数据加载中...");d()},1300)})}else{if(f.event==="sortUp"||f.event==="sortDown"){ajaxPost($opt_url,f,"",function(){layLoad("数据加载中...");d()})}else{layError("该按钮未绑定事件")}}});e("#pushMenu").click(function(){ajaxPost($push_url,{},"确定要发布菜单吗？",function(){layOk("发布成功")})});e("#createMenu").click(function(){ajaxPost($reset_url,{},"确定要重置为默认菜单吗？",function(){layOk("重置成功");setTimeout(function(){layLoad("数据加载中...");d()},1300)})});e("#openAll").click(function(){b.expandAll("#table-block")});e("#hideAll").click(function(){b.foldAll("#table-block")})});