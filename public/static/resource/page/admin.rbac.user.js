layui.use(["jquery","layer","table","form"],function(){var d=layui.jquery,a=layui.layer,c=layui.table,b=layui.form;layLoad("数据加载中...");c.render({elem:"#table-block",url:data_url,loading:true,cols:[[{title:"序号",type:"numbers"},{field:"name",title:"用户名称",align:"center",minWidth:120},{field:"login_name",title:"登录账号",align:"center",minWidth:200},{field:"last_login_time",title:"最后登录时间",align:"center",minWidth:200},{field:"last_login_ip",title:"最后登录ip",align:"center",minWidth:200},{title:"用户状态",align:"center",minWidth:200,templet:function(g){var e=g.status_name+"&nbsp;";var f=parseInt(g.status);switch(f){case 1:e+='<a class="layui-btn layui-btn-danger layui-btn-xs" lay-event="off">禁用</a>';break;case 2:e+='<a class="layui-btn layui-btn-danger layui-btn-xs" lay-event="on">启用</a>';break}return e}},{title:"操作",align:"center",minWidth:320,templet:function(f){var e="";var g=parseInt(f.id);e+='<a class="layui-btn layui-btn-normal layui-btn-xs" lay-event="resetpwd">重置登录密码</a>';if(g!==1){e+='<a class="layui-btn layui-btn-normal layui-btn-xs" href="'+f.do_url+'">编辑</a>';e+='<a class="layui-btn layui-btn-danger layui-btn-xs" lay-event="delete">删除</a>'}return e}}]],page:true,height:"full-220",response:{statusCode:1},id:"table-block",done:function(e){a.closeAll()}});c.on("tool(table-block)",function(g){var f=g.data;var e={id:f.id,event:g.event};var h="";switch(g.event){case"on":h="确定要启用该用户吗？";break;case"off":h="确定要禁用该用户吗？";break;case"delete":h="确定要将该删除该用户吗？";break;case"resetpwd":h="确定要将该用户登录密码重置为123456吗？";break}if(h){ajaxPost(do_url,e,h,function(){layOk("操作成功");if(g.event!=="resetpwd"){setTimeout(function(){layLoad("数据加载中...");c.reload("table-block")},1400)}})}else{layError("该按钮未绑定事件")}});b.on("submit(table-search)",function(f){var e=f.field;layLoad("数据加载中...");c.reload("table-block",{where:e,page:{curr:1}})})});