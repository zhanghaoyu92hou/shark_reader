layui.use(["jquery","form","upload"],function(){var e=layui.jquery,d=layui.form,c=layui.upload,f,b;var a=e(".icon-input-div").length;a=a?(a-1):0;e("#addInput").click(function(){var g=e(".icon-input-div").length;if(g>=5){layError("仅可添加5个图标");return false}a++;var h="";h+='<div class="layui-col-md6 layui-col-sm6">';h+='<div class="icon-input-div">';h+='<a href="javascript:void(0);" class="layui-btn layui-btn-sm layui-btn-danger delete-btn"><i class="layui-icon layui-icon-delete"></i>删除</a>';h+='<div class="layui-form-item">';h+='<div class="image-div">';h+='<div class="image-box size-100x100 show-upload" title="点击上传图标">';h+='<img src="/static/common/images/300x300.png" class="showimg"/>';h+='<input type="hidden" class="hideval" name="src['+a+']" value=""/>';h+="</div>";h+="</div>";h+="</div>";h+='<div class="layui-form-item">';h+='<div class="layui-inline">';h+='<input type="text" class="layui-input" name="text['+a+']" placeholder="请输入图标标题"/>';h+="</div>";h+="</div>";h+='<div class="layui-form-item">';h+='<input type="text" class="layui-input" name="link['+a+']" placeholder="请输入跳转链接"/>';h+="</div>";h+="</div>";h+="</div>";e("#iconBox").append(h)});e("body").on("click",".show-upload",function(){b=e(this);e(".upload-loading").hide();e(".upload-remark").show();uplayer=layer.open({type:1,shade:false,title:"上传图标",shade:[0],offset:"100px",area:"630px",content:e(".imgLayer")})});e("body").on("click",".delete-btn",function(){e(this).parent().parent().remove()});c.render({elem:".zip-btn-div",url:$up_url,accept:"images",acceptMime:"image/jpg,image/jpeg,image/png",exts:"jpg|jpeg|png",size:100,drag:false,choose:function(g){var h='<div class="upload-state-div"><span></span><font>文件上传中...</font></div>';e(".upload-loading").html(h);e(".upload-loading").show();e(".upload-remark").hide()},done:function(g){if(g.code===1){var i=g.data.url;b.find(".showimg").attr("src",i);b.find(".hideval").val(i);layer.close(uplayer)}else{var h='<div class="upload-state-div"><font class="text-red">'+g.msg+"</font></div>";e(".upload-loading").html(h)}},error:function(){layError("上传失败,请重试");e(".upload-loading").hide();e(".upload-remark").show()}});d.on("submit(dosubmit)",function(h){var g=h.field;ajaxPost("",g,"确定要保存吗？",function(i){layOk("保存成功")})})});