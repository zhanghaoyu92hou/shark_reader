getHistory();
function doSearch(a) {
    if (!a) {
        a = $("#keyword").val()
    }
    if (a.length == 0) {
        layMsg("请输入搜索关键字");
        return false
    }
    $(".searchHistory").hide();
    ajaxPost("", {
        keyword: a
    },
    function(c) {
        var b = 0;
        if (c) {
            var d = "<ul>";
            $.each(c,
            function(e, f) {
                d += "<li>";
                d += '<div class="recommendPos">';
                d += '<div class="recommendHotImg">';
                d += '<a href="' + f.info_url + '">';
                d += '<img src="' + f.cover + '" alt="">';
                d += "</a>";
                d += "</div>";
                d += '<div class="recommendFont">';
                d += '<h4 class="over">';
                d += '<a href="' + f.info_url + '">' + f.name + "</a>";
                d += "</h4>";
                d += '<p class="over2 read_p">';
                d += '<a href="' + f.info_url + '">';
                d += f.summary;
                d += "</a>";
                d += "</p>";
                d += '<div class="historyTag">';
                d += '<a href="javascript:void(0);" class="active_lz">' + f.over_type + "</a>";
                if (f.category) {
                    for (var e = 0; e < f.category.length; e++) {
                        d += '<a href="javascript:void(0)">' + f.category[e] + "</a>"
                    }
                }
                d += "</div>";
                d += '<div class="historyNumber">';
                d += "<div>";
                d += "<span>";
                if (f.type === 3) {
                    d += '<img src="/static/index/images/cartoonHeadset.png" alt="">'
                } else {
                    d += '<img src="/static/index/images/cartoon_ico1.jpg" alt="">'
                }
                d += "<em>" + f.hot_num + "</em>";
                d += "</span>";
                d += "<span>";
                d += '<img src="/static/index/images/cartoon_ico2.jpg" alt="">';
                d += "<em>" + f.total_chapter + "章</em>";
                d += "</span>";
                d += "</div>";
                if (f.type == 3) {
                    d += '<a href="' + f.info_url + '" class="readStar ripple">开始收听</a>'
                } else {
                    d += '<a href="' + f.info_url + '" class="readStar ripple">开始阅读</a>'
                }
                d += "</div>";
                d += "</div>";
                d += "</div>";
                d += "</li>"
            });
            d += "</ul>";
            $(".recommendList").html(d)
        } else {
            var d = "";
            d += '<div class="searchTs">';
            d += '<img src="/static/index/images/searchBg.png" alt="">';
            d += "<p>抱歉亲亲～</p>";
            d += "<p>没有相关内容</p>";
            d += "</div>";
            d += '<div class="promptly" style="margin: 10% auto">';
            d += '<a href="/" class="ripple">去找几本漫画小说看看</a>';
            d += "</div>";
            $(".recommendList").html(d)
        }
    })
}
function getHistory() {
    var a = U("getHistory");
    if (a) {
        ajaxPost(a, {},
        function(b) {
            if (b) {
                var c = "";
                $.each(b,
                function(d, e) {
                    c += "<li>";
                    c += "<div>";
                    c += '<img src="/static/index/images/timeHIstory.png" alt="">';
                    c += '<p class="over"><a href="javascript:;" onclick="javascript:doSearch(\'' + e.keyword + "');\">" + e.keyword + "</a></p>";
                    c += '<a href="javascript:;" onclick="javascript:delOne(\'' + e.id + '\',this);"><img src="/static/index/images/close.png" alt=""></a>';
                    c += "</div>";
                    c += "</li>"
                });
                $(".searchList>ul").html(c);
                $(".searchHistory").show()
            }
        })
    }
}
function delOne(d, c) {
    var a = U("delOne");
    var b = {
        id: d
    };
    ajaxPost(a, b,
    function() {
        $(c).parents("li").remove()
    })
}
function delAll() {
    var a = U("delAll");
    ajaxPost(a, {},
    function() {
        $(".searchList").html("<ul></ul>");
        $(".searchHistory").hide()
    })
}
$(function() {
    a();
    $(window).resize(function() {
        a()
    });
    function a() {
        var b = $("body").width();
        $(".searchFixed").width(b)
    }
});