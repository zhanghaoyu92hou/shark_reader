$(function() {
    a();
    checkCollect();
    c();
    $(window).resize(function() {
        c()
    });
    function c() {
        var d = $("body").width();
        $(".footer").width(d - 60);
        $(".menuFooterFixed").width(d);
        $(".fixedScrool").width(d)
    }
    var b = 0;
    function a() {
        var h = window.innerHeight;
        var f = $(window).scrollTop();
        var g = $(document).height();
        var e = $(".fixedScrool").innerHeight();
        var d = [h, f, g, e];
        return d
    }
    $(window).scroll(function() {
        var d = a();
        var h = d[0];
        var f = d[1];
        var g = d[2];
        var e = d[3];
        if (f <= h / 10) {
            $(".height_50").hide()
        } else {
            if (f + h >= g) {
                $(".height_50").hide();
                $(".menuFooter").removeClass("menuFooterFixed")
            } else {
                if (f > b) {
                    $(".menuFooter").removeClass("menuFooterFixed");
                    $(".fixedScrool").removeClass("active");
                    $(".cartoonCount").css("marginTop", 0);
                    $(".chase>a").removeClass("active")
                } else {
                    if (f < b) {
                        $(".menuFooter").addClass("menuFooterFixed");
                        $(".fixedScrool").addClass("active");
                        $(".cartoonCount").css("marginTop", e);
                        $(".chase>a").addClass("active")
                    }
                }
            }
        }
        b = f
    });
    $(document).on("tap",
    function() {
        var d = a();
        var h = d[0];
        var f = d[1];
        var g = d[2];
        var e = d[3];
        if (f + h >= g) {
            $(".height_50").hide();
            $(".menuFooter").removeClass("menuFooterFixed")
        } else {
            $(".menuFooter").addClass("menuFooterFixed");
            $(".fixedScrool").addClass("active");
            $(".cartoonCount").css("marginTop", e);
            $(".chase>a").addClass("active")
        }
    })
});
function checkPrev() {
    cur_number = cur_number > 0 ? cur_number: 1;
    var b = 1;
    if (cur_number > 1) {
        b = cur_number - 1
    }
    var a = U("read");
    a += "?book_id=" + book_id + "&number=" + b;
    window.location.href = a
}
function checkNext() {
    var a = U("checkNext");
    if (a) {
        cur_number = cur_number > 0 ? cur_number: 1;
        var b = 1;
        if (cur_number > 0) {
            b = cur_number + 1
        }
        ajaxPost(a, {
            book_id: book_id,
            number: b
        },
        function(c) {
            switch (c.flag) {
            case 0:
                window.location.href = c.url;
                break;
            case 1:
                layer.open({
                    content:
                    c.msg,
                    btn: ["确定", "取消"],
                    yes: function(d) {
                        layer.close(d);
                        window.location.href = c.url
                    }
                });
                break;
            case 2:
                layer.open({
                    content:
                    "您的书币余额不足，是否立即充值?",
                    btn: ["确定", "取消"],
                    yes: function(d) {
                        layer.close(d);
                        window.location.href = c.url
                    }
                });
                break;
            case 3:
                layer.open({
                    content:
                    c.msg,
                    btn: ["确定", "取消"],
                    yes: function(d) {
                        layer.close(d);
                        window.location.href = c.url
                    }
                });
                break;
            case 4:
                toAttention();
                break
            }
        })
    }
}
function doCollect(b) {
    if (!$(b).hasClass("active")) {
        var a = U("Com/doCollect");
        if (a) {
            ajaxPost(a, {
                book_id: book_id
            },
            function() {
                layMsg("收藏成功");
                $(b).addClass("active")
            })
        }
    }
}
function checkCollect() {
    var a = U("Com/doCheckCollect");
    if (a) {
        ajaxPost(a, {
            book_id: book_id
        },
        function(b) {
            if (b.flag === 1) {
                $(".collectSc").addClass("active")
            }
        })
    }
}
function followBook() {
    layer.open({
        content: $(".followbook_dom").html(),
        shadeClose: false,
        className: "chaseLayer",
        style: "background-color:#fff; color:#fff; border:none;    border-radius:20px ;"
    })
}
function toAttention() {
    layer.open({
        content: $(".attention_dom").html(),
        shadeClose: false,
        className: "chaseLayer",
        style: "background-color:#fff; color:#fff; border:none;border-radius:20px ;"
    })
}
function toDir() {
    var a = U("info");
    if (a) {
        a += "?book_id=" + book_id + "&is_dir=1";
        window.location.href = a
    }
};