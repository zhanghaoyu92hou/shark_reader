$(function () {
    $(".chargeCount>ul>li").click(function () {
        $(this).addClass("active").siblings().removeClass("active");
        if (paytype == '4') {
            $('.paytype-container').show()
        }
    });
    $(".paytype-closer").click(function () {
        $('.paytype-container').hide()
    });
    a();
    $(window).resize(function () {
        a()
    });
    function a() {
        var b = $("body").width();
        $(".footer").width(b - 60)
    }
    $('.paytype li').on('click', function () {
        var paytype = $(this).attr('data-payway')
        $('#paytype').val(paytype);
        $('.paytype-container').hide()
    })
    $("#doCharge").click(function () {
  
        var e = $(".chargeCount ul .active");
        var c = e.index();
        var b = e.find(".charge_money").val();
        if (c < 0 || b <= 0) {
            layer.open({
                content: "充值数据有误",
                skin: "msg",
                time: 2
            });
            return false
        }
        var pay = $('#paytype').val();
    
        var d = {
            charge_key: c,
            charge_money: b,
            book_id: book_id,
            video_id: video_id,
            paytype:pay
        };


        $.ajax({
            type: "post",
            data: d,
            dataType: "json",
            beforeSend: function () {
                layer.open({
                    type: 2
                })
            },
            success: function (f) {
            	console.log(f)
            	   layer.closeAll()
                if (f.code == 1) {
             
                	  if (paytype == '5') {
                     var jshtm='<div class="payarea"><label><input name="CpayType" type="radio" value="alipay" checked />支付宝 <p><img src="/static/index/images/yzf_alipay.png"></p></label> <label><input name="CpayType" type="radio" value="qqpay" />QQ <p><img src="/static/index/images/yzf_qqpay.png"></p></label><label><input name="CpayType" type="radio" value="wxpay" />微信 <p><img src="/static/index/images/yzf_wxpay.png"></p></label></div>';
						               //信息框
						  layer.open({
						    btn: ['确定支付', '取消'],
						    content: '<div class="paytitle">请选择支付方式：</div>'+jshtm
						    ,yes: function(index){
						      var CpayType=  $("input[name='CpayType']:checked").val();
						         //	alert(CpayType)
						         	   window.location.href = f.data.url+CpayType;
						    }
						 
						  });
                       return false
                      }
                	
                    window.location.href = f.data.url
                } else {
                    layer.open({
                        content: f.msg,
                        skin: "msg",
                        time: 2
                    })
                }
             
            },
            complete: function () {
                
            },
            error: function () {
                layer.closeAll()
            }
        })
    })
});